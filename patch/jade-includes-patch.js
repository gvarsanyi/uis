// Generated by CoffeeScript 1.7.1
(function() {
  var jade;

  jade = require('jade');

  jade.Parser.prototype._parseInclude = jade.Parser.prototype.parseInclude;

  jade.Parser.prototype.parseInclude = function() {
    var file, item, list, p, path, tok, _base, _i, _len, _ref;
    if ((list = (_ref = this.options) != null ? _ref.includes : void 0) && typeof list === 'object') {
      tok = this.peek();
      path = this.resolvePath(tok.val.trim(), 'include');
      p = require('path');
      file = p.resolve(this.filename);
      path = p.resolve(path);
      if (list instanceof Array) {
        for (_i = 0, _len = list.length; _i < _len; _i++) {
          item = list[_i];
          if (item === path) {
            return this._parseInclude();
          }
        }
        list.push(path);
      } else {
        if (list[file] == null) {
          list[file] = {};
        }
        if ((_base = list[file])[path] == null) {
          _base[path] = [];
        }
        list[file][path].push(tok.line);
      }
    }
    return this._parseInclude();
  };

}).call(this);
